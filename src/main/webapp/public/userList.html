<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户列表</title>
    <script src="../scripts/boot.js" type="text/javascript"></script>
    <script src="../scripts/jquery-3.3.1.min.js" type="text/javascript"></script>
    <link href="../scripts/miniui/themes/blue/skin.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        html, body{
            margin:0;padding:0;border:0;width:100%;height:100%;overflow:hidden;
        }
    </style>
</head>
<body>
    <div style="width:100%;">
        <div class="mini-toolbar" style="border-bottom:0;padding:0px;">
            <table style="width:100%;">
                <tr>
                    <td style="width:100%;">
                        <a class="mini-button" iconCls="icon-add" onclick="add()">增加</a>
                        <a class="mini-button" iconCls="icon-add" onclick="edit()">编辑</a>
                        <a class="mini-button" iconCls="icon-remove" onclick="remove()">删除</a>
                    </td>
                    <td style="white-space:nowrap;">
                        <input id="key" class="mini-textbox" emptyText="请输入姓名" style="width:150px;" onenter="onKeyEnter"/>
                        <a class="mini-button" onclick="search()">查询</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="mini-fit" >
        <div id="userList" class="mini-datagrid" style="width:100%;height:100%;" idField="id"
             allowResize="true" pageSize="20"
             allowCellEdit="true" allowCellSelect="true" multiSelect="true"
             editNextOnEnterKey="true"  editNextRowCell="true"">
            <div property="columns">
                <div type="checkcolumn" ></div>
                <div field="id" width="100%" headerAlign="center" allowSort="true">id</div>
                <div field="loginname" width="100%" headerAlign="center" allowSort="true">登录名</div>
                <div field="password" width="100%" headerAlign="center" allowSort="true">密码</div>
                <div field="username" width="100%" headerAlign="center" allowSort="true">用户名</div>
                <div field="status" width="100%" headerAlign="center" allowSort="true">状态</div>
                <div field="createdate" width="100%" headerAlign="center" dateFormat="yyyy-MM-dd" allowSort="true">创建日期</div>
            </div>
        </div>
    </div>
</body>

<script type="text/javascript">
    mini.parse();

    var grid = mini.get("userList");
    var searchAllUser = "/user/searchAllUser";
    function searchUsers(){
        // $.ajax({
        //     url:searchAllUser,
        //     type: "post",
        //     success: function(e){
        //         console.log(mini.encode(e));
        //         // grid.load(mini.encode(e));
        //         var grid = mini.get("userList");
        //         grid.setData(e);
        //     },
        //     error: function(){mini.alert("加载错误，请重试一下");}
        // });
        grid.setUrl(searchAllUser);
        grid.load();
    }
    searchUsers();

    // grid.load();

    // var data = [{"id":1}];
    // alert(data);
    // grid.setData(data);

    //
    // function add() {
    //
    //     mini.open({
    //         targetWindow: window,
    //
    //         url: bootPATH + "../demo/CommonLibs/EmployeeWindow.html",
    //         title: "新增员工", width: 600, height: 400,
    //         onload: function () {
    //             var iframe = this.getIFrameEl();
    //             var data = { action: "new" };
    //             iframe.contentWindow.SetData(data);
    //         },
    //         ondestroy: function (action) {
    //
    //             grid.reload();
    //         }
    //     });
    // }

    // function edit() {
    //
    //     var row = grid.getSelected();
    //     if (row) {
    //         mini.open({
    //             url: bootPATH + "../demo/CommonLibs/EmployeeWindow.html",
    //             title: "编辑员工", width: 600, height: 400,
    //             onload: function () {
    //                 var iframe = this.getIFrameEl();
    //                 var data = { action: "edit", id: row.id };
    //                 iframe.contentWindow.SetData(data);
    //
    //             },
    //             ondestroy: function (action) {
    //                 //var iframe = this.getIFrameEl();
    //
    //                 grid.reload();
    //
    //             }
    //         });
    //
    //     } else {
    //         alert("请选中一条记录");
    //     }
    //
    // }
    // function remove() {
    //
    //     var rows = grid.getSelecteds();
    //     if (rows.length > 0) {
    //         if (confirm("确定删除选中记录？")) {
    //             var ids = [];
    //             for (var i = 0, l = rows.length; i < l; i++) {
    //                 var r = rows[i];
    //                 ids.push(r.id);
    //             }
    //             var id = ids.join(',');
    //             grid.loading("操作中，请稍后......");
    //             $.ajax({
    //                 url: "../data/AjaxService.aspx?method=RemoveEmployees&id=" +id,
    //                 success: function (text) {
    //                     grid.reload();
    //                 },
    //                 error: function () {
    //                 }
    //             });
    //         }
    //     } else {
    //         alert("请选中一条记录");
    //     }
    // }
    // function search() {
    //     var key = mini.get("key").getValue();
    //     grid.load({ key: key });
    // }
    // function onKeyEnter(e) {
    //     search();
    // }
    // /////////////////////////////////////////////////
    // function onBirthdayRenderer(e) {
    //     var value = e.value;
    //     if (value) return mini.formatDate(value, 'yyyy-MM-dd');
    //     return "";
    // }
    // function onMarriedRenderer(e) {
    //     if (e.value == 1) return "是";
    //     else return "否";
    // }
    // var Genders = [{ id: 1, text: '男' }, { id: 2, text: '女'}];
    // function onGenderRenderer(e) {
    //     for (var i = 0, l = Genders.length; i < l; i++) {
    //         var g = Genders[i];
    //         if (g.id == e.value) return g.text;
    //     }
    //     return "";
    // }

</script>


</html>